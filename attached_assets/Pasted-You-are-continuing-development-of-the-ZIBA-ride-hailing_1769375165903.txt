You are continuing development of the ZIBA ride-hailing app.
Phases 1â€“14.5 are COMPLETE and MUST NOT be modified.

IMPLEMENT PHASE 15 â€” MULTI-COUNTRY TAX, CURRENCY & COMPLIANCE.

This phase prepares ZIBA for international operation without enabling real tax payments yet.

DO NOT BREAK EXISTING FEATURES.
EXTEND ONLY.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
OBJECTIVES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1) Support multi-country configuration
2) Support multi-currency pricing & reporting
3) Introduce tax rules per country/region
4) Prepare compliance metadata for audits
5) Keep all tax calculations READ-ONLY (simulation)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CORE PRINCIPLES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ NO automatic tax remittance
â€¢ NO government API integrations
â€¢ NO real tax filing
â€¢ Reporting + configuration ONLY

This phase is about correctness and readiness.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DATABASE (Prisma)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Add the following models:

Country
- id
- name
- isoCode (e.g. NG, US, UK)
- currency (ISO 4217, e.g. NGN, USD)
- timezone
- active
- createdAt

TaxRule
- id
- countryId
- name
- taxType (VAT | SALES | SERVICE | OTHER)
- rate (percentage)
- appliesTo (FARE | COMMISSION | BOTH)
- effectiveFrom
- effectiveTo (nullable)
- createdAt

ExchangeRate
- id
- baseCurrency
- targetCurrency
- rate
- asOfDate
- source (MANUAL)
- createdAt

ComplianceProfile
- id
- countryId
- legalEntityName
- registrationId (optional)
- taxId (optional)
- notes
- createdAt

Ensure indexes on countryId and currency.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SYSTEM BEHAVIOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1) Trips
- Each trip is linked to a Country
- Currency is derived from country

2) Pricing
- All fares stored in base currency
- Converted values shown using ExchangeRate (read-only)

3) Tax Calculation (Simulation)
- Apply TaxRule to completed trips
- Store calculated tax amounts for reporting
- DO NOT affect wallet balances

4) Organizations (Trip Coordinators)
- Taxes calculated under organizationâ€™s country
- Shown on receipts as "Estimated Tax"

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
API ROUTES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

GET  /api/countries
POST /api/countries/create
POST /api/countries/update

GET  /api/tax-rules?countryId=
POST /api/tax-rules/create

GET  /api/exchange-rates
POST /api/exchange-rates/update

GET  /api/compliance/overview
GET  /api/compliance/reports?countryId=

Strict RBAC:
- ADMIN / FINANCE only

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
UI (ADMIN)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Add Admin tabs/sections:

ğŸŒ Countries
- Active countries
- Currency display

ğŸ§¾ Tax Rules
- Tax rate per country
- Effective dates

ğŸ’± Exchange Rates
- Manual rate entry
- Rate history

ğŸ“‘ Compliance
- Country-level summaries
- Tax exposure reports
- Exportable (CSV/PDF)

NO rider or driver UI changes.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
REPORTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Extend Phase 12 reports to include:
- Revenue by country
- Tax exposure by country
- Currency-converted summaries

Reports must be READ-ONLY.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
AUDIT & SAFETY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ No wallet mutations
â€¢ No payout impact
â€¢ No automatic deductions
â€¢ All calculations traceable
â€¢ Full AuditLog coverage

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FINAL CHECKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ Existing pricing unchanged
â€¢ Wallets & payouts unaffected
â€¢ Analytics still accurate
â€¢ App compiles cleanly

IMPLEMENT PHASE 15 ONLY.
