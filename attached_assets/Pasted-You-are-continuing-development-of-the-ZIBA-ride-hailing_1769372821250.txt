You are continuing development of the ZIBA ride-hailing app.
Phases 10A (Refunds), 10B (Chargebacks), 11 (Wallets & Payouts),
12 (Analytics), and 13 (Fraud Detection) are COMPLETE and MUST NOT be modified.

IMPLEMENT PHASE 14 â€” DRIVER INCENTIVES, BONUSES & PROMOTIONS.

DO NOT BREAK EXISTING FEATURES.
EXTEND ONLY.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
OBJECTIVES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1) Incentivize driver activity and retention
2) Support bonuses, streak rewards, and promotions
3) Credit incentives safely into driver wallets
4) Prevent abuse using fraud & risk signals
5) Provide admin controls for incentive programs

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ROLES & ACCESS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ADMIN
FINANCE
DRIVER
TRIP_COORDINATOR

â€¢ ADMIN: Create, manage, pause incentives
â€¢ FINANCE: Approve payout-impacting incentives
â€¢ DRIVER: View earned incentives
â€¢ TRIP_COORDINATOR: View-only

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
INCENTIVE TYPES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Support the following incentive programs:

1) TRIP BONUS
   - Complete X trips â†’ earn $Y

2) STREAK BONUS
   - Complete trips for N consecutive days

3) PEAK TIME BONUS
   - Trips during defined time windows

4) QUALITY BONUS
   - Maintain rating â‰¥ threshold

5) PROMO CAMPAIGN
   - Limited-time incentives (city / region based)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DATABASE (Prisma)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Add the following models:

IncentiveProgram
- id
- name
- type (TRIP | STREAK | PEAK | QUALITY | PROMO)
- criteria (JSON)
- rewardAmount
- currency
- startAt
- endAt
- status (ACTIVE | PAUSED | ENDED)
- createdAt

IncentiveEarning
- id
- programId
- driverId
- amount
- status (PENDING | APPROVED | PAID | REVOKED)
- evaluatedAt
- paidAt (nullable)

Ensure indexes on programId, driverId, status.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
BUSINESS RULES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1) Incentives are evaluated on:
- Trip completion
- Daily summary job
- Manual admin trigger

2) Fraud Protection:
- HIGH or CRITICAL risk drivers cannot earn incentives
- Incentives auto-hold if fraud events are unresolved

3) Wallet Integration:
- Approved incentives â†’ CREDIT to driver wallet
- Must use WalletTransaction ledger
- Never mutate wallet balance directly

4) Revocation:
- Admin may revoke incentives for abuse
- Reversal logged and wallet adjusted

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
API ROUTES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

POST /api/incentives/create
POST /api/incentives/update
POST /api/incentives/pause
GET  /api/incentives/active
GET  /api/incentives/driver/:id
POST /api/incentives/evaluate
POST /api/incentives/revoke

Strict RBAC enforcement.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
UI (ADMIN + DRIVER)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ADMIN TAB: ğŸ Incentives
- Active programs
- Performance metrics
- Pause / End actions

DRIVER VIEW:
- Active incentives
- Progress indicators
- Earned bonuses history

NO rider-facing incentives yet.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
AUDIT & SAFETY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ All incentive actions log to AuditLog
â€¢ No incentives bypass fraud system
â€¢ No direct wallet balance edits
â€¢ All reversals are traceable

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FINAL CHECKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ Wallets & payouts unaffected
â€¢ Fraud system respected
â€¢ Incentives credited correctly
â€¢ App compiles cleanly

IMPLEMENT PHASE 14 ONLY.
